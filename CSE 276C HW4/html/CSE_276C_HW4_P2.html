
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>CSE_276C_HW4_P2</title><meta name="generator" content="MATLAB 9.10"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2021-11-20"><meta name="DC.source" content="CSE_276C_HW4_P2.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">--------------------------------------------------------</a></li><li><a href="#3">Smaller Step Size, h = 0.1</a></li></ul></div><pre class="codeinput"><span class="comment">% Name          : Kai Chuen Tan</span>
<span class="comment">% Title         : Homework 4</span>
<span class="comment">% Course        : CSE 276C: Mathematics for Robotics</span>
<span class="comment">% Professor     : Dr. Henrik I. Christensen</span>
<span class="comment">% Date          : 13th November 2021</span>

clear <span class="string">all</span>;
clc; close <span class="string">all</span>;

fprintf(<span class="string">'Name          : Kai Chuen Tan\n'</span>)
fprintf(<span class="string">'Title         : Homework 4\n'</span>)
fprintf(<span class="string">'Course        : CSE 276C: Mathematics for Robotics\n'</span>)
fprintf(<span class="string">'Professor     : Dr. Henrik I. Christensen\n'</span>)
fprintf(<span class="string">'Date          : 13th November 2021\n\n'</span>)
fprintf(<span class="string">'--------------------------------------------------------\n\n'</span>)
</pre><pre class="codeoutput">Name          : Kai Chuen Tan
Title         : Homework 4
Course        : CSE 276C: Mathematics for Robotics
Professor     : Dr. Henrik I. Christensen
Date          : 13th November 2021

--------------------------------------------------------

</pre><h2 id="2">--------------------------------------------------------</h2><p>Problem 2 - Solving Predator-prey Model with Runge-Kutta</p><pre class="codeinput">fprintf(<span class="string">'Problem 2 - Solving Predator-prey Model with Runge-Kutta\n'</span>)
fprintf(<span class="string">'--------------------------------------------------------------------\n\n'</span>)

<span class="comment">% Initialize the coefficients</span>
b = 1; p = 1; r = 1; d = 1;

<span class="comment">% Time interval</span>
t0 = 0; <span class="comment">% Initial Time</span>
t_final = 50; <span class="comment">% Final Time</span>

<span class="comment">% Step size</span>
h = 1;

<span class="comment">% Number of intervals</span>
n = (t_final - t0) / h;

<span class="comment">% Time Array (1 x n+1)</span>
t = zeros(1, n+1);
t(1) = t0;

<span class="comment">% Prey array, x1 (1 x n+1)</span>
x_prey = zeros(1, n+1);
x_prey(1) = 0.3;

<span class="comment">% Predator array, x2 (1 x n+1)</span>
x_predator = zeros(1, n+1);
x_predator(1) = 0.2;

<span class="comment">% Define Lotka-Volterra Predator-prey Model.</span>
<span class="comment">% x1 - Prey Population</span>
<span class="comment">% x2 - Predator Population</span>
dx1_dt = @(x1, x2) (b - p * x2) * x1;
dx2_dt = @(x1, x2) (r * x1 - d) * x2;

<span class="comment">% Runge-Kutta Fourth Order</span>
[t, x_prey, x_predator] = ODE_Runge_Kutta_4(dx1_dt, dx2_dt, t, x_prey, x_predator, h, n);

<span class="comment">% Plot Populations Over Time and Phase Plane</span>
plot_Populations_Over_Time(t,x_prey, x_predator)
plot_Phase_Plane(x_prey,x_predator)

<span class="comment">% Print Comment on the Results</span>
fprintf(<span class="string">"Figure 2 - Phase Plane Plot illustrates that it somewhat converges to an orbit with a step size of 1,\n"</span>)
fprintf(<span class="string">"but due to the large global error, O(h^5), it does not converge back to the initial point. Hence, the step\n"</span>)
fprintf(<span class="string">"size will adjusted to a smaller step size, which is 0.1.\n\n"</span>)
</pre><pre class="codeoutput">Problem 2 - Solving Predator-prey Model with Runge-Kutta
--------------------------------------------------------------------

Figure 2 - Phase Plane Plot illustrates that it somewhat converges to an orbit with a step size of 1,
but due to the large global error, O(h^5), it does not converge back to the initial point. Hence, the step
size will adjusted to a smaller step size, which is 0.1.

</pre><img vspace="5" hspace="5" src="CSE_276C_HW4_P2_01.png" alt=""> <img vspace="5" hspace="5" src="CSE_276C_HW4_P2_02.png" alt=""> <h2 id="3">Smaller Step Size, h = 0.1</h2><p>Step size</p><pre class="codeinput">h = 0.1;

<span class="comment">% Number of intervals</span>
n = (t_final - t0) / h;

<span class="comment">% Time Array (1 x n+1)</span>
t = zeros(1, n+1);
t(1) = t0;

<span class="comment">% Prey array, x1 (1 x n+1)</span>
x_prey = zeros(1, n+1);
x_prey(1) = 0.3;

<span class="comment">% Predator array, x2 (1 x n+1)</span>
x_predator = zeros(1, n+1);
x_predator(1) = 0.2;

<span class="comment">% Runge-Kutta Fourth Order</span>
[t, x_prey, x_predator] = ODE_Runge_Kutta_4(dx1_dt, dx2_dt, t, x_prey, x_predator, h, n);

<span class="comment">% Plot Populations Over Time and Phase Plane</span>
plot_Populations_Over_Time(t,x_prey, x_predator)
plot_Phase_Plane(x_prey,x_predator)

<span class="comment">% Print Comment on the Results</span>
fprintf(<span class="string">"Figure 4 - Phase Plane Plot illustrates that it converges to an orbit with a step size of 0.1,\n"</span>)
fprintf(<span class="string">"Figure 3 - Populations of Prey and Predator Over Time presents that as the prey population increases,\n"</span>)
fprintf(<span class="string">"the predator population started to rise exponentially due to the increase in foods. However, as the \n"</span>)
fprintf(<span class="string">"predator increases exponentially, the prey population starts to drop drastically. Because of the drastic\n"</span>)
fprintf(<span class="string">"drop in the prey population, the predator population starts to drop as well due to insufficient food.\n"</span>)
fprintf(<span class="string">"The drop in prey and predator populations continues until the prey and predator populations reach\n"</span>)
fprintf(<span class="string">"the initial prey population value and the initial predator population value as shown in the Figure 4 -\n"</span>)
fprintf(<span class="string">"Phase Plane Plot. Then, the cycle will repeat.\n"</span>)
</pre><pre class="codeoutput">Figure 4 - Phase Plane Plot illustrates that it converges to an orbit with a step size of 0.1,
Figure 3 - Populations of Prey and Predator Over Time presents that as the prey population increases,
the predator population started to rise exponentially due to the increase in foods. However, as the 
predator increases exponentially, the prey population starts to drop drastically. Because of the drastic
drop in the prey population, the predator population starts to drop as well due to insufficient food.
The drop in prey and predator populations continues until the prey and predator populations reach
the initial prey population value and the initial predator population value as shown in the Figure 4 -
Phase Plane Plot. Then, the cycle will repeat.
</pre><img vspace="5" hspace="5" src="CSE_276C_HW4_P2_03.png" alt=""> <img vspace="5" hspace="5" src="CSE_276C_HW4_P2_04.png" alt=""> <p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2021a</a><br></p></div><!--
##### SOURCE BEGIN #####
% Name          : Kai Chuen Tan
% Title         : Homework 4
% Course        : CSE 276C: Mathematics for Robotics
% Professor     : Dr. Henrik I. Christensen
% Date          : 13th November 2021

clear all;
clc; close all;

fprintf('Name          : Kai Chuen Tan\n')
fprintf('Title         : Homework 4\n')
fprintf('Course        : CSE 276C: Mathematics for Robotics\n')
fprintf('Professor     : Dr. Henrik I. Christensen\n')
fprintf('Date          : 13th November 2021\n\n')
fprintf('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH\n\n')

%% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
% Problem 2 - Solving Predator-prey Model with Runge-Kutta
fprintf('Problem 2 - Solving Predator-prey Model with Runge-Kutta\n')
fprintf('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH\n\n')

% Initialize the coefficients
b = 1; p = 1; r = 1; d = 1;

% Time interval
t0 = 0; % Initial Time
t_final = 50; % Final Time

% Step size
h = 1;

% Number of intervals
n = (t_final - t0) / h;

% Time Array (1 x n+1)
t = zeros(1, n+1);
t(1) = t0;

% Prey array, x1 (1 x n+1)
x_prey = zeros(1, n+1);
x_prey(1) = 0.3;

% Predator array, x2 (1 x n+1)
x_predator = zeros(1, n+1);
x_predator(1) = 0.2;

% Define Lotka-Volterra Predator-prey Model.
% x1 - Prey Population
% x2 - Predator Population
dx1_dt = @(x1, x2) (b - p * x2) * x1;
dx2_dt = @(x1, x2) (r * x1 - d) * x2;

% Runge-Kutta Fourth Order
[t, x_prey, x_predator] = ODE_Runge_Kutta_4(dx1_dt, dx2_dt, t, x_prey, x_predator, h, n);

% Plot Populations Over Time and Phase Plane
plot_Populations_Over_Time(t,x_prey, x_predator)
plot_Phase_Plane(x_prey,x_predator)

% Print Comment on the Results
fprintf("Figure 2 - Phase Plane Plot illustrates that it somewhat converges to an orbit with a step size of 1,\n") 
fprintf("but due to the large global error, O(h^5), it does not converge back to the initial point. Hence, the step\n")
fprintf("size will adjusted to a smaller step size, which is 0.1.\n\n")
%% Smaller Step Size, h = 0.1
% Step size
h = 0.1;

% Number of intervals
n = (t_final - t0) / h;

% Time Array (1 x n+1)
t = zeros(1, n+1);
t(1) = t0;

% Prey array, x1 (1 x n+1)
x_prey = zeros(1, n+1);
x_prey(1) = 0.3;

% Predator array, x2 (1 x n+1)
x_predator = zeros(1, n+1);
x_predator(1) = 0.2;

% Runge-Kutta Fourth Order
[t, x_prey, x_predator] = ODE_Runge_Kutta_4(dx1_dt, dx2_dt, t, x_prey, x_predator, h, n);

% Plot Populations Over Time and Phase Plane
plot_Populations_Over_Time(t,x_prey, x_predator)
plot_Phase_Plane(x_prey,x_predator)

% Print Comment on the Results
fprintf("Figure 4 - Phase Plane Plot illustrates that it converges to an orbit with a step size of 0.1,\n") 
fprintf("Figure 3 - Populations of Prey and Predator Over Time presents that as the prey population increases,\n")
fprintf("the predator population started to rise exponentially due to the increase in foods. However, as the \n")
fprintf("predator increases exponentially, the prey population starts to drop drastically. Because of the drastic\n")
fprintf("drop in the prey population, the predator population starts to drop as well due to insufficient food.\n")
fprintf("The drop in prey and predator populations continues until the prey and predator populations reach\n")
fprintf("the initial prey population value and the initial predator population value as shown in the Figure 4 -\n")
fprintf("Phase Plane Plot. Then, the cycle will repeat.\n")
##### SOURCE END #####
--></body></html>